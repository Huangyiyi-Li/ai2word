# 个性化设置与格式修复 - 需求文档

## 版本信息

- 日期：2026-02-25
- 版本：v1.2.0

## 需求概述

### 1. Host Permissions 管理功能

- 在插件侧边栏添加"支持的网站"管理区域
- 允许用户手动输入域名添加 host_permissions
- 支持"添加当前页面"一键添加
- 内置支持：ChatGPT、Claude、DeepSeek、通义千问、文心一言、Kimi、**Gemini**、**Monica**
- 用户自定义域名使用 `chrome.storage.sync` 持久化

### 2. Word 导出标题格式修复

- **问题描述**：Markdown 标题中的内联样式（如 `**粗体**`、`*斜体*`）在导出 Word 时未被正确解析，显示为纯 Markdown 标记而非格式化文本
- **修复方案**：标题内容使用 `parseTextStyles` 解析内联样式，同时保持 Word Heading 级别
- blockquote 的斜体和颜色改为可配置

### 3. 个性化设置系统

支持以下设置项：

| 设置项 | 说明 | 默认值 |
| :--- | :--- | :--- |
| 保留标题内联样式 | 标题中的粗体/斜体等同步到 Word | ✅ 开启 |
| 保留粗体格式 | `**粗体**` 同步到 Word | ✅ 开启 |
| 保留斜体格式 | `*斜体*` 同步到 Word | ✅ 开启 |
| 去除多余空格 | 去除 AI 生成内容中标点前的多余空格 | ❌ 关闭 |
| 引用块使用斜体 | blockquote 在 Word 中以斜体显示 | ✅ 开启 |

## 影响范围

### 修改文件清单

- `extension/manifest.json` - 新增 monica.im 权限和 gemini/monica content_scripts
- `extension/background.js` - 更新 supportedDomains
- `extension/content/content.js` - 添加 Gemini 和 Monica 平台选择器
- `extension/sidepanel/sidepanel.html` - 设置面板 UI
- `extension/sidepanel/sidepanel.js` - 设置面板交互逻辑
- `extension/sidepanel/sidepanel.css` - 设置面板样式
- `extension/lib/converter.js` - 设置系统 + 标题/列表格式修复
- `webapp/index.html` - 网页版设置面板
